<?xml version="1.0" encoding="ISO-8859-1"?>
<model version="2.1">
  <id>b2a34056-d5cd-4de8-9af8-7b51a4f248b2</id>
  <name>GenerateImageProvider</name>
  <changecounter>157</changecounter>
  <sib>
    <id>64a32e2e-03eb-437a-8d64-183fed477869</id>
    <name>PutExpression</name>
    <label>LocalPkgName</label>
    <sib-uid>basic-sibs/PutExpression</sib-uid>
    <taxonomy>de.jabc.sib.common.basic.PutExpression</taxonomy>
    <position>69.5,48.0</position>
    <parameter name="resolve">
      <boolean>true</boolean>
    </parameter>
    <parameter name="value">
      <de.metaframe.common.sib.parameter.ContextExpression>
        <ContextExpressionFoundation>
          <expression>${packageName}.graphiti</expression>
          <clazz>java.lang.Object</clazz>
          <classMutable>true</classMutable>
        </ContextExpressionFoundation>
      </de.metaframe.common.sib.parameter.ContextExpression>
    </parameter>
    <parameter name="variable">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>localPkgName</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
    <userobject key="ABC$START">
      <boolean>true</boolean>
    </userobject>
  </sib>
  <sib>
    <id>e85879da-fd9d-4260-9075-d16d63373a69</id>
    <name>PutExpression_1</name>
    <label>ClassName</label>
    <sib-uid>basic-sibs/PutExpression</sib-uid>
    <taxonomy>de.jabc.sib.common.basic.PutExpression</taxonomy>
    <position>80.5,168.0</position>
    <parameter name="resolve">
      <boolean>true</boolean>
    </parameter>
    <parameter name="value">
      <de.metaframe.common.sib.parameter.ContextExpression>
        <ContextExpressionFoundation>
          <expression>${graphModelName}ImageProvider</expression>
          <clazz>java.lang.Object</clazz>
          <classMutable>true</classMutable>
        </ContextExpressionFoundation>
      </de.metaframe.common.sib.parameter.ContextExpression>
    </parameter>
    <parameter name="variable">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>className</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <edge>
    <source>64a32e2e-03eb-437a-8d64-183fed477869</source>
    <target>e85879da-fd9d-4260-9075-d16d63373a69</target>
    <point>120.0,75.0</point>
    <point>120.0,195.0</point>
    <labelposition>500.0,0.0</labelposition>
    <branch>default</branch>
  </edge>
  <sib>
    <id>7de3828e-6b35-41ca-9519-879cdc30e3f2</id>
    <name>RunStringTemplate</name>
    <label>RunStringTemplate</label>
    <sib-uid>script-sibs/RunStringTemplate</sib-uid>
    <taxonomy>de.jabc.sib.common.script.RunStringTemplate</taxonomy>
    <position>55.0,498.0</position>
    <parameter name="append">
      <boolean>true</boolean>
    </parameter>
    <parameter name="individualVariables">
      <boolean>false</boolean>
    </parameter>
    <parameter name="result">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>ipContent</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="template">
      <string>package $context.packageName$.graphiti;


import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.util.Enumeration;
import java.util.Hashtable;
import java.util.Map.Entry;


import org.eclipse.core.resources.*;
import org.eclipse.core.runtime.*;
import org.eclipse.core.runtime.FileLocator;
import org.eclipse.core.runtime.Platform;
import org.eclipse.emf.common.util.URI;
import org.eclipse.graphiti.ui.platform.AbstractImageProvider;
import org.eclipse.graphiti.ui.platform.IImageProvider;
import org.osgi.framework.Bundle;

public class $context.graphModelName$ImageProvider extends AbstractImageProvider 
	implements IImageProvider {

	private Hashtable&lt;String, String&gt; images;
	
	public $context.fuGraphModelName$ImageProvider() {
		$context.fuGraphModelName$GraphitiUtils.getInstance().setImageProvider(this);
	}

	public void addImage(String id, String path) {
		if (images == null) {
			images = new Hashtable&lt;String, String&gt;();
		}
		images.put(id, path);
		addAvailableImages();
	}
	
	public String getImageId(String path) {
		for (Entry&lt;String, String&gt; e : images.entrySet()){
			if (e.getValue().equals(path))
				return e.getKey();
		}
		
		return &quot;&quot;;
	}

	@Override
	protected void addAvailableImages() {
		if (images == null) {
			images = new Hashtable&lt;String, String&gt;();
		}
		for (Entry&lt;String, String&gt; e : images.entrySet()) {
			if (getImageFilePath(e.getKey()) == null)
				addImageFilePath(e.getKey(), e.getValue());
		}
	}

	public void initImages() {
		Bundle b = Platform.getBundle(&quot;$context.projectName$&quot;);
		File file;
		try {
			URL url = null;
			$context.iconsContent$

			file = FileLocator.getBundleFile(b);
			File genIconsFile = file.toPath().resolve(&quot;resources-gen/icons&quot;).toFile();
			if (genIconsFile.exists()) {
				for (File f : genIconsFile.listFiles()){
					String fileName = f.getName();
					String id = fileName;
					addImage(id, &quot;/resources-gen/icons/&quot;+fileName);
				}
			}
			if (!genIconsFile.exists() ) {
				Enumeration&lt;URL&gt; entries = b.findEntries(&quot;resources-gen/icons/&quot;, &quot;*&quot;, true);
				while(entries.hasMoreElements()){
					URL entry = entries.nextElement();
					IPath path = new Path(entry.getPath());
					File i = path.toFile();
					String fileName = i.getName();
					String id = fileName;
					addImage(id, path.toString());
				}
			}
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
}</string>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <edge>
    <source>e85879da-fd9d-4260-9075-d16d63373a69</source>
    <target>d45629de-0804-4fa8-af2f-92e7e45a8513</target>
    <point>138.0,193.52727272727273</point>
    <point>267.0,240.43636363636364</point>
    <labelposition>500.0,0.0</labelposition>
    <branch>default</branch>
  </edge>
  <sib>
    <id>a7bdee39-2ac1-4edc-bfcf-bb08373ffac6</id>
    <name>WriteJavaFile</name>
    <label>WriteJavaFile</label>
    <sib-uid>genesys-sibs/WriteJavaFile</sib-uid>
    <taxonomy>de.jabc.sib.genesys.WriteJavaFile</taxonomy>
    <position>73.0,603.0</position>
    <parameter name="baseDirectory">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>outletPath</key>
          <scope>GLOBAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="beautify">
      <boolean>false</boolean>
    </parameter>
    <parameter name="beautifyMethod">
      <de.metaframe.common.sib.parameter.ListBox>
        <ListBoxFoundation>
          <list>
            <string>Eclipse</string>
            <string>Jalopy</string>
          </list>
          <selected>0</selected>
        </ListBoxFoundation>
      </de.metaframe.common.sib.parameter.ListBox>
    </parameter>
    <parameter name="className">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>className</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="fileContent">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>ipContent</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="packageName">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>localPkgName</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <edge>
    <source>7de3828e-6b35-41ca-9519-879cdc30e3f2</source>
    <target>a7bdee39-2ac1-4edc-bfcf-bb08373ffac6</target>
    <point>120.0,525.0</point>
    <point>120.0,630.0</point>
    <labelposition>500.0,0.0</labelposition>
    <branch>default</branch>
  </edge>
  <sib>
    <id>7af3ef94-1c10-45e6-9397-4d1700858284</id>
    <name>PrintConsoleMessage</name>
    <label>PrintConsoleMessage</label>
    <sib-uid>io-sibs/PrintConsoleMessage</sib-uid>
    <taxonomy>de.jabc.sib.common.io.PrintConsoleMessage</taxonomy>
    <position>46.5,738.0</position>
    <parameter name="error">
      <boolean>false</boolean>
    </parameter>
    <parameter name="message">
      <de.metaframe.common.sib.parameter.ContextExpression>
        <ContextExpressionFoundation>
          <expression>Wrote ImageProvider</expression>
          <clazz>java.lang.Object</clazz>
          <classMutable>false</classMutable>
        </ContextExpressionFoundation>
      </de.metaframe.common.sib.parameter.ContextExpression>
    </parameter>
    <finalbranches>default</finalbranches>
  </sib>
  <edge>
    <source>a7bdee39-2ac1-4edc-bfcf-bb08373ffac6</source>
    <target>7af3ef94-1c10-45e6-9397-4d1700858284</target>
    <point>120.0,630.0</point>
    <point>120.0,765.0</point>
    <labelposition>500.0,0.0</labelposition>
    <branch>default</branch>
  </edge>
  <sib>
    <id>d45629de-0804-4fa8-af2f-92e7e45a8513</id>
    <name>GetAllIcons</name>
    <label>GetAllIcons</label>
    <sib-uid>ge-util-sibs/GetAllIcons</sib-uid>
    <taxonomy>de.jabc.cinco.meta.core.ge.style.sibs.common.GetAllIcons</taxonomy>
    <position>84.5,273.0</position>
    <parameter name="graphModelKey">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>graphModel</key>
          <scope>GLOBAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="iconsListKey">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>icons</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <sib>
    <id>074ca43a-108b-4bb2-9e7a-659207ddb9c1</id>
    <name>IterateElements</name>
    <label>IterateElements</label>
    <sib-uid>collection-sibs/IterateElements</sib-uid>
    <taxonomy>de.jabc.sib.common.collection.IterateElements</taxonomy>
    <position>71.0,393.0</position>
    <parameter name="collection">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconKeys</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="element">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconKey</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="iterator">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconPathIterator</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>error</finalbranches>
    <finalbranches>exit</finalbranches>
    <finalbranches>next</finalbranches>
  </sib>
  <edge>
    <source>d45629de-0804-4fa8-af2f-92e7e45a8513</source>
    <target>a776cbd4-aa4d-4e1e-a356-78602b918cd1</target>
    <point>138.0,299.28</point>
    <point>252.0,344.88</point>
    <labelposition>500.0,0.0</labelposition>
    <branch>default</branch>
  </edge>
  <edge>
    <source>074ca43a-108b-4bb2-9e7a-659207ddb9c1</source>
    <target>5e381fc0-c2f4-46f9-9d28-a9f19fcd24c8</target>
    <point>138.0,402.675</point>
    <point>342.0,300.675</point>
    <labelposition>500.0,0.0</labelposition>
    <branch>next</branch>
  </edge>
  <sib>
    <id>f4c8f617-3985-4c3d-9dbb-9821a7b4696b</id>
    <name>RunStringTemplate_1</name>
    <label>RunStringTemplate</label>
    <sib-uid>script-sibs/RunStringTemplate</sib-uid>
    <taxonomy>de.jabc.sib.common.script.RunStringTemplate</taxonomy>
    <position>317.0,393.0</position>
    <parameter name="append">
      <boolean>true</boolean>
    </parameter>
    <parameter name="individualVariables">
      <boolean>true</boolean>
    </parameter>
    <parameter name="result">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconsContent</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="template">
      <string>/*addImage(&quot;$iconID$&quot;, &quot;$iconKey$&quot;);*/

url = FileLocator.find(b, new Path(&quot;$iconKey$&quot;), null);
addImage(&quot;$iconKey$&quot;, url.getPath());
</string>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <edge>
    <source>f4c8f617-3985-4c3d-9dbb-9821a7b4696b</source>
    <target>074ca43a-108b-4bb2-9e7a-659207ddb9c1</target>
    <spline/>
    <point>357.0,419.1</point>
    <point>255.0,465.0</point>
    <point>138.0,418.2</point>
    <labelposition>477.0,-55.0</labelposition>
    <branch>default</branch>
  </edge>
  <edge>
    <source>074ca43a-108b-4bb2-9e7a-659207ddb9c1</source>
    <target>7de3828e-6b35-41ca-9519-879cdc30e3f2</target>
    <point>120.0,405.0</point>
    <point>127.0,529.0</point>
    <branch>exit</branch>
  </edge>
  <sib>
    <id>a776cbd4-aa4d-4e1e-a356-78602b918cd1</id>
    <name>GetMapKeys</name>
    <label>GetMapKeys</label>
    <sib-uid>collection-sibs/GetMapKeys</sib-uid>
    <taxonomy>de.jabc.sib.common.collection.GetMapKeys</taxonomy>
    <position>186.0,273.0</position>
    <parameter name="keys">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconKeys</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="map">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>icons</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <sib>
    <id>5e381fc0-c2f4-46f9-9d28-a9f19fcd24c8</id>
    <name>GetElement</name>
    <label>GetElement</label>
    <sib-uid>collection-sibs/GetElement</sib-uid>
    <taxonomy>de.jabc.sib.common.collection.GetElement</taxonomy>
    <position>218.0,393.0</position>
    <parameter name="element">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconID</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="index">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>iconKey</key>
          <scope>LOCAL</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <parameter name="list">
      <de.metaframe.jabc.framework.sib.parameter.ContextKey>
        <ContextKeyFoundation>
          <key>icons</key>
          <scope>DECLARED</scope>
          <scopeMutable>true</scopeMutable>
        </ContextKeyFoundation>
      </de.metaframe.jabc.framework.sib.parameter.ContextKey>
    </parameter>
    <finalbranches>default</finalbranches>
    <finalbranches>error</finalbranches>
  </sib>
  <edge>
    <source>a776cbd4-aa4d-4e1e-a356-78602b918cd1</source>
    <target>074ca43a-108b-4bb2-9e7a-659207ddb9c1</target>
    <point>210.34883720930233,309.0</point>
    <point>137.02702702702703,393.0</point>
    <branch>default</branch>
  </edge>
  <edge>
    <source>5e381fc0-c2f4-46f9-9d28-a9f19fcd24c8</source>
    <target>f4c8f617-3985-4c3d-9dbb-9821a7b4696b</target>
    <point>255.0,420.0</point>
    <point>388.0,407.0</point>
    <branch>default</branch>
  </edge>
  <values/>
  <branch>
    <name>default</name>
    <branch>default</branch>
    <sib>7af3ef94-1c10-45e6-9397-4d1700858284</sib>
  </branch>
  <branch>
    <name>error</name>
    <branch>error</branch>
    <sib>a7bdee39-2ac1-4edc-bfcf-bb08373ffac6</sib>
  </branch>
  <branch>
    <name>error</name>
    <branch>error</branch>
    <sib>7de3828e-6b35-41ca-9519-879cdc30e3f2</sib>
  </branch>
  <branch>
    <name>error</name>
    <branch>error</branch>
    <sib>e85879da-fd9d-4260-9075-d16d63373a69</sib>
  </branch>
  <branch>
    <name>error</name>
    <branch>error</branch>
    <sib>64a32e2e-03eb-437a-8d64-183fed477869</sib>
  </branch>
</model>